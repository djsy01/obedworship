<template>
  <div class="page">
    <section class="section">
      <div class="section-header">
        <div>
          <h1 class="section-title">OBED Worship ë¹„ì „</h1>
          <p class="section-subtitle">
            ìˆœì¢…ê³¼ ê²½ì™¸ë¡œ ì£¼ë‹˜ê³¼ ì†Œí†µí•˜ëŠ” ì˜ˆë°° ê³µë™ì²´ì˜ ë¹„ì „ê³¼ íŒ€ì›ë“¤ì„ ì†Œê°œí•©ë‹ˆë‹¤.
          </p>
        </div>
      </div>

      <div class="bible-verse">
        <blockquote>
          <p>
            "ë„ˆí¬ëŠ” ë„ˆí¬ í•˜ë‚˜ë‹˜ ì—¬í˜¸ì™€ë¥¼ ìˆœì¢…í•˜ë©°, ê·¸ë¥¼ ê²½ì™¸í•˜ë©° ê·¸ ëª…ë ¹ì„ ì§€í‚¤ë©°<br />
            ê·¸ ëª©ì†Œë¦¬ë¥¼ ì²­ì¢…í•˜ë©°, ê·¸ë¥¼ ì„¬ê¸°ë©° ê·¸ì—ê²Œ ë¶€ì¢…í•˜ê³ "
          </p>
          <cite>- ì‹ ëª…ê¸° 13:4 -</cite>
        </blockquote>
      </div>

      <div class="team-description">
        <div class="highlight-box">
          ë¹ ë¥´ê²Œ ë³€í™”í•´ê°€ëŠ” ì„¸ìƒ ì†ì—ì„œ ì£¼ë‹˜ì„ í–¥í•´ ë‘ë ¤ì›€ì„ ë‚´ë ¤ë†“ê³  ëª©ì†Œë¦¬ë¡œ ì£¼ë‹˜ê³¼ ì†Œí†µí•˜ëŠ” ì°¬ì–‘íŒ€
        </div>
        <div class="highlight-box">
          ì²­ì¤‘ë“¤ê³¼ í•¨ê»˜ ì†Œí†µí•˜ë©° ì˜ˆë°°ì˜ ì¤‘ì‹¬ì´ ì£¼ë‹˜ê»˜ ë‚´ë ¤ë†“ëŠ” ì°¬ì–‘íŒ€
        </div>
        <div class="highlight-box">
          ì§‘íšŒë¥¼ ì¤€ë¹„í•˜ëŠ” ê³¼ì •ì—ì„œ ì—­í• ì— ë”°ë¼ ë¬´ì—‡ì´ ì¤‘ìš”í•œì§€ ê³ ë¯¼í•˜ë©°, ë‹¤ìŒ ì„¸ëŒ€ë¥¼ ìœ„ë¡œí•˜ê³  í•¨ê»˜ ì„±ì¥í•˜ê¸° ìœ„í•¨
        </div>
        <div class="highlight-box">
          ì£¼ë‹˜ì˜ ì‚¬ë‘ì„ ìŠê³  ì‚´ì•„ê°€ëŠ” ì‚¬ëŒë“¤ì—ê²Œ "ë„ˆí¬ëŠ” ìŠì–´ë„ ê·¸ë¦¬ìŠ¤ë„ì´ì‹  ì£¼ë‹˜ê»˜ì„œëŠ” ì•„ì§ë„ ìš°ë¦´ ì°¾ê³  ìˆë‹¤"ëŠ” ê²ƒì„ ë‹¤ì‹œê¸ˆ ê¹¨ë‹«ê²Œ í•˜ê¸° ìœ„í•´
        </div>
      </div>

      <div class="team-member-section">
        <h2 class="section-title-sub">íŒ€ì› ì†Œê°œ</h2>

        <!-- Main Filter -->
        <div class="position-filter">
          <button
            class="filter-btn"
            :class="{ active: filter === 'all' }"
            @click="handleMainFilter('all')"
          >
            All
          </button>
          <button
            class="filter-btn"
            :class="{ active: filter === 'leader' }"
            @click="handleMainFilter('leader')"
          >
            Leader
          </button>
          <button
            class="filter-btn"
            :class="{ active: filter === 'worship' }"
            @click="handleMainFilter('worship')"
          >
            Worship
          </button>
          <button
            class="filter-btn"
            :class="{ active: filter === 'step' }"
            @click="handleMainFilter('step')"
          >
            Step
          </button>
        </div>

        <!-- Worship Sub-filters -->
        <div v-if="filter === 'worship'" class="worship-filters">
          <button
            class="filter-btn small"
            :class="{ active: worshipFilter === '' }"
            @click="worshipFilter = ''"
          >
            Worship All
          </button>
          <button
            class="filter-btn small"
            :class="{ active: worshipFilter === 'Vocal' }"
            @click="worshipFilter = 'Vocal'"
          >
            Vocal
          </button>
          <button
            class="filter-btn small"
            :class="{ active: worshipFilter === 'Piano' }"
            @click="worshipFilter = 'Piano'"
          >
            Piano
          </button>
          <button
            class="filter-btn small"
            :class="{ active: worshipFilter === 'Guitar' }"
            @click="worshipFilter = 'Guitar'"
          >
            Guitar
          </button>
          <button
            class="filter-btn small"
            :class="{ active: worshipFilter === 'Drum' }"
            @click="worshipFilter = 'Drum'"
          >
            Drum
          </button>
        </div>

        <!-- Step Sub-filters -->
        <div v-if="filter === 'step'" class="step-filters">
          <button
            class="filter-btn small"
            :class="{ active: stepFilter === '' }"
            @click="stepFilter = ''"
          >
            Step All
          </button>
          <button
            class="filter-btn small"
            :class="{ active: stepFilter === 'Planning Team' }"
            @click="stepFilter = 'Planning Team'"
          >
            Planning Team
          </button>
          <button
            class="filter-btn small"
            :class="{ active: stepFilter === 'FOH' }"
            @click="stepFilter = 'FOH'"
          >
            FOH
          </button>
          <button
            class="filter-btn small"
            :class="{ active: stepFilter === 'Media' }"
            @click="stepFilter = 'Media'"
          >
            Media
          </button>
          <button
            class="filter-btn small"
            :class="{ active: stepFilter === 'Setup & Tech' }"
            @click="stepFilter = 'Setup & Tech'"
          >
            Setup & Tech
          </button>
        </div>

        <!-- Member Grid -->
        <div class="member-grid">
          <div
            v-for="member in filteredMembers"
            :key="member.id"
            class="member-card"
          >
            <img
              :src="member.photo_url"
              :alt="member.name"
              class="member-photo"
            />
            <div class="member-info">
              <h3 class="member-name">{{ member.name }}</h3>
              
              <!-- Affiliation Badge -->
              <span class="affiliation-badge">{{ member.affiliation }}</span>
              
              <!-- Roles (Leader) -->
              <div v-if="member.roles.length > 0" class="member-roles">
                <span v-for="role in member.roles" :key="role" class="role-badge">
                  {{ role }}
                </span>
              </div>
              
              <!-- Positions (í•„í„°ì— ë”°ë¼ ë‹¤ë¥´ê²Œ í‘œì‹œ) -->
              <div class="member-positions">
                <!-- All í•„í„°: ëª¨ë“  í¬ì§€ì…˜ -->
                <template v-if="filter === 'all'">
                  <span v-for="pos in member.worship_positions" :key="pos" class="position-badge worship">
                    {{ pos }}
                  </span>
                  <span v-for="pos in member.step_positions" :key="pos" class="position-badge step">
                    {{ pos }}
                  </span>
                </template>
                
                <!-- Worship í•„í„°: Worship í¬ì§€ì…˜ë§Œ -->
                <template v-else-if="filter === 'worship'">
                  <span v-for="pos in member.worship_positions" :key="pos" class="position-badge worship">
                    {{ pos }}
                  </span>
                </template>
                
                <!-- Step í•„í„°: Step í¬ì§€ì…˜ë§Œ -->
                <template v-else-if="filter === 'step'">
                  <span v-for="pos in member.step_positions" :key="pos" class="position-badge step">
                    {{ pos }}
                  </span>
                </template>
                
                <!-- Leader í•„í„°: ì—­í• ë§Œ (ì´ë¯¸ ìœ„ì— í‘œì‹œë¨) -->
              </div>
              
              <!-- Social Links -->
              <div class="social-links">
                <a
                  v-if="member.instagram_url"
                  :href="member.instagram_url"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="icon-link"
                  title="Instagram"
                >
                  <img :src="instagramIcon" alt="Instagram" class="social-icon" />
                </a>
                <a
                  v-if="member.youtube_url"
                  :href="member.youtube_url"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="icon-link"
                  title="YouTube"
                >
                  <img :src="youtubeIcon" alt="YouTube" class="social-icon" />
                </a>
              </div>
            </div>
          </div>

          <p v-if="filteredMembers.length === 0" class="empty-text">
            ì¡°ê±´ì— ë§ëŠ” íŒ€ì›ì´ ì—†ìŠµë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </section>
  </div>
</template>

<script setup lang="ts">
import { computed, ref } from 'vue'
import '../styles/Vision.css'
import logo from '@/assets/image/LOGO.JPG'
import photoGiin from '@/assets/people/Giin.jpeg'
import photoMijung from '@/assets/people/mijung.jpeg'
import photoInho from '@/assets/people/inho.JPG'
import photoDrumWook from '@/assets/people/DrumWook.jpeg'
import photoJungsuk from '@/assets/people/jungsuk.jpeg'
import photoOnnew from '@/assets/people/onnew.jpeg'
import photoJongeon from '@/assets/people/Jongeon.jpeg'
import photoYesol from '@/assets/people/yesol.jpeg'
import instagramIcon from '@/assets/icons/Instargram.png'
import youtubeIcon from '@/assets/icons/youtube.png'

type Member = {
  id: number
  name: string
  affiliation: string
  photo_url: string
  instagram_url: string | null
  youtube_url: string | null
  roles: string[]
  worship_positions: string[]
  step_positions: string[]
  description: string
}

const filter = ref<'all' | 'leader' | 'worship' | 'step'>('all')
const worshipFilter = ref<string>('')
const stepFilter = ref<string>('')

// ì‹¤ì œ íŒ€ì› ë°ì´í„°
const members = ref<Member[]>([
  // ğŸŸ¦ ì„ì›ì§„
  {
    id: 1,
    name: 'ë°•í›ˆ ëª©ì‚¬',
    affiliation: 'ëª©ì‚¬',
    photo_url: logo,
    instagram_url: 'https://www.instagram.com/holyforest.jpg',
    youtube_url: null,
    roles: ['Pastor'],
    worship_positions: [],
    step_positions: [],
    description: 'OBED ì˜ì  ì´ê°ë…, ì´ˆì²­ ê°„ì‚¬/ëª©ì‚¬ ì„­ì™¸'
  },
  {
    id: 2,
    name: 'ì´ê¸°ì¸ ì¥ë¡œ',
    affiliation: 'ì¥ë…„ë¶€',
    photo_url: photoGiin,
    instagram_url: 'https://www.instagram.com/somanja59',
    youtube_url: null,
    roles: ['Elder'],
    worship_positions: ['Acoustic Guitar'],
    step_positions: [],
    description: 'ì°¬ì–‘ìœ„ì›íšŒ, ì–´ì¿ ìŠ¤í‹±'
  },
  {
    id: 3,
    name: 'ê¹€ë¯¸ì •',
    affiliation: 'ì¥ë…„ë¶€',
    photo_url: photoMijung,
    instagram_url: 'https://www.instagram.com/cat0925_',
    youtube_url: null,
    roles: ['Accounting'],
    worship_positions: [],
    step_positions: [],
    description: 'ì¬ì • ë‹´ë‹¹, ì˜ˆë°° ì¸ë ¥ ì„­ì™¸, ìš´ì˜ ì§€ì›'
  },
  {
    id: 4,
    name: 'ì—„ì¸í˜¸',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: photoInho,
    instagram_url: 'https://www.instagram.com/djsy_01',
    youtube_url: 'https://www.youtube.com/@djsy01',
    roles: ['Worship Team Leader'],
    worship_positions: ['Vocal', 'Acoustic Guitar'],
    step_positions: ['Live Engineer', 'Mix Engineer', 'Music Producer'],
    description: 'OBED íŒ€ì¥ + í˜„ ì¸ë„ì + ì–´ì¿ ìŠ¤í‹±, ë¬´ëŒ€ êµ¬ìƒ, í”„ë¦¬í”„ë¡œë•ì…˜, ìŒí–¥ ì„¤ê³„, í›„ë°˜ ë¯¹ì‹± â†’ OBED ìŒì•…Â·ì˜ˆë°°Â·ìŒí–¥ ë””ë ‰í„°'
  },
  {
    id: 5,
    name: 'ë°•ìƒìš±',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: photoDrumWook,
    instagram_url: 'https://www.instagram.com/drum_wook02',
    youtube_url: 'https://youtube.com/channel/UC_vv_fm_8e3O8xTb5TbPKrg',
    roles: ['Session Leader'],
    worship_positions: ['Drum'],
    step_positions: ['Live Engineer', 'Camera Operator', 'Video Editor'],
    description: 'OBED ë¶€íŒ€ì¥(ì„¸ì…˜íŒ€ì¥) + ë“œëŸ¼ or FOH(ì—”ì§€ë‹ˆì–´ or ì´¬ì˜ë‹´ë‹¹) + í”„ë¦¬í”„ë¡œë•ì…˜ ë³´ì¡° + í›„ë°˜ ë¯¹ì‹±, ì´¬ì˜ êµ¬ë„ + ì´¬ì˜ ì¥ë¹„ ì„­ì™¸ + ì˜ìƒ í¸ì§‘ + ìœ íŠœë¸Œ ì±„ë„ ê´€ë¦¬ â†’ Music + Live Sound + Video í…Œí¬ ë¦¬ë”'
  },
  {
    id: 6,
    name: 'ì „ì˜ˆì›',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: logo,
    instagram_url: 'https://www.instagram.com/winnie_the_ron_02',
    youtube_url: null,
    roles: ['Planning Team Leader'],
    worship_positions: ['Vocal'],
    step_positions: ['Planning Team'],
    description: 'í™ë³´íŒ€ íŒ€ì¥ + ì½˜í…ì¸  ë°©í–¥ ì¡°ìœ¨ + ì‹±ì–´'
  },

  // ğŸŸ© íŒ€ì›
  {
    id: 7,
    name: 'ê¹€ì˜¨ìœ ',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: photoOnnew,
    instagram_url: 'https://www.instagram.com/onyourmusic',
    youtube_url: 'https://www.youtube.com/@onyourmusic',
    roles: [],
    worship_positions: ['Vocal'],
    step_positions: ['Planning Team'],
    description: 'í™ë³´íŒ€ + ì‹±ì–´'
  },
  {
    id: 8,
    name: 'ê¹€ì •ì„',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: photoJungsuk,
    instagram_url: 'https://www.instagram.com/_kjs_1127',
    youtube_url: null,
    roles: [],
    worship_positions: ['Bass Guitar'],
    step_positions: ['Lighting Operator'],
    description: 'ì¡°ëª… + ë² ì´ìŠ¤'
  },
  {
    id: 9,
    name: 'ë§ˆìŠ¹ë¹ˆ',
    affiliation: 'ê³ ë“±ë¶€',
    photo_url: logo,
    instagram_url: 'https://www.instagram.com/z.sbbxn_',
    youtube_url: null,
    roles: [],
    worship_positions: ['Drum'],
    step_positions: ['Planning Team'],
    description: 'í™ë³´íŒ€ + ë“œëŸ¼'
  },
  {
    id: 10,
    name: 'ë°•ì†Œë¼',
    affiliation: 'ì¥ë…„ë¶€',
    photo_url: logo,
    instagram_url: null,
    youtube_url: null,
    roles: [],
    worship_positions: ['Synthesizer'],
    step_positions: ['Planning Team'],
    description: 'í™ë³´íŒ€ + ì„¸ì»¨ê±´ë°˜'
  },
  {
    id: 11,
    name: 'ì‹ ì˜ˆì†”',
    affiliation: 'ê³ ë“±ë¶€',
    photo_url: photoYesol,
    instagram_url: 'https://www.instagram.com/yz_sol5',
    youtube_url: 'https://youtube.com/channel/UCvyHxOBm7RDwCo62pFBwVSA',
    roles: [],
    worship_positions: ['Vocal'],
    step_positions: ['Planning Team'],
    description: 'í™ë³´íŒ€ + ì‹±ì–´'
  },
  {
    id: 12,
    name: 'ì‹ ì§€ì€',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: logo,
    instagram_url: 'https://www.instagram.com/_wldms.3',
    youtube_url: null,
    roles: [],
    worship_positions: ['Piano'],
    step_positions: ['Planning Team'],
    description: 'í™ë³´íŒ€ + ë©”ì¸ê±´ë°˜'
  },
  {
    id: 13,
    name: 'ì˜¤ì¢…ì–¸',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: photoJongeon,
    instagram_url: 'https://www.instagram.com/5_bells_05',
    youtube_url: null,
    roles: [],
    worship_positions: ['Vocal'],
    step_positions: ['Live Engineer', 'Music Producer'],
    description: 'ë¬´ëŒ€êµ¬ìƒ + í”„ë¦¬í”„ë¡œë•ì…˜ ë³´ì¡° + ì‹±ì–´ + ìŒí–¥ ì„¤ê³„'
  },
  {
    id: 14,
    name: 'ì˜¤í˜„ëª…',
    affiliation: 'ì¥ë…„ë¶€',
    photo_url: logo,
    instagram_url: 'https://www.instagram.com/5rosy_n_5lira',
    youtube_url: null,
    roles: [],
    worship_positions: ['Piano'],
    step_positions: ['Audio Setup'],
    description: 'ë©”ì¸ê±´ë°˜ + ìŒí–¥ ì„¤ê³„ ë³´ì¡°'
  },
  {
    id: 15,
    name: 'ìœ ê·¼ì„œ',
    affiliation: 'ì²­ë…„ë¶€',
    photo_url: logo,
    instagram_url: null,
    youtube_url: null,
    roles: [],
    worship_positions: ['Lead Guitar'],
    step_positions: ['Audio Setup', 'Presentation Operator'],
    description: 'ë¦¬ë“œê¸°íƒ€ + ìŒí–¥ ì„¤ê³„ ë³´ì¡° + PPT ì œì‘'
  },
  {
    id: 16,
    name: 'ì§€ìš©ë¯¼',
    affiliation: 'ì¥ë…„ë¶€',
    photo_url: logo,
    instagram_url: null,
    youtube_url: null,
    roles: [],
    worship_positions: ['Vocal'],
    step_positions: ['Lighting Operator'],
    description: 'ì‹±ì–´ + ì¡°ëª… ë³´ì¡°'
  },
  {
    id: 17,
    name: 'ìµœì˜',
    affiliation: 'ì¥ë…„ë¶€',
    photo_url: logo,
    instagram_url: 'https://www.instagram.com/breeze2174',
    youtube_url: null,
    roles: [],
    worship_positions: ['Vocal'],
    step_positions: ['Audio Setup'],
    description: 'ì‹±ì–´(í™”ìŒ) + ìŒí–¥ ì„¤ê³„ ë³´ì¡°'
  }
])

// í•„í„°ë§ ë¡œì§
const filteredMembers = computed(() => {
  let filtered = members.value

  // Main Filter
  if (filter.value === 'leader') {
    filtered = filtered.filter(m => m.roles.length > 0)
  } else if (filter.value === 'worship') {
    filtered = filtered.filter(m => m.worship_positions.length > 0)
  } else if (filter.value === 'step') {
    filtered = filtered.filter(m => m.step_positions.length > 0)
  }

  // Worship Sub-filter
  if (filter.value === 'worship' && worshipFilter.value) {
    if (worshipFilter.value === 'Piano') {
      filtered = filtered.filter(m =>
        m.worship_positions.some(p => ['Piano', 'Synthesizer'].includes(p))
      )
    } else if (worshipFilter.value === 'Guitar') {
      filtered = filtered.filter(m =>
        m.worship_positions.some(p =>
          ['Acoustic Guitar', 'Lead Guitar', 'Backing Guitar', 'Bass Guitar'].includes(p)
        )
      )
    } else {
      filtered = filtered.filter(m =>
        m.worship_positions.includes(worshipFilter.value)
      )
    }
  }

  // Step Sub-filter
  if (filter.value === 'step' && stepFilter.value) {
    if (stepFilter.value === 'Planning Team') {
      filtered = filtered.filter(m =>
        m.step_positions.includes('Planning Team') || m.roles.includes('Planning Team Leader')
      )
    } else if (stepFilter.value === 'FOH') {
      filtered = filtered.filter(m =>
        m.step_positions.some(p =>
          ['Live Engineer', 'Camera Operator', 'Presentation Operator'].includes(p)
        )
      )
    } else if (stepFilter.value === 'Media') {
      filtered = filtered.filter(m =>
        m.step_positions.some(p =>
          ['Mix Engineer', 'Master Engineer', 'Video Editor'].includes(p)
        )
      )
    } else if (stepFilter.value === 'Setup & Tech') {
      filtered = filtered.filter(m =>
        m.step_positions.some(p =>
          ['Audio Setup', 'Lighting Operator', 'Stage Manager'].includes(p)
        )
      )
    }
  }

  // Worship í•„í„°ì¼ ë•Œë§Œ íŠ¹ë³„í•œ ì •ë ¬ ì ìš©
  if (filter.value === 'worship') {
    filtered.sort((a, b) => {
      // ì •ë ¬ ìš°ì„ ìˆœìœ„ ê³„ì‚° í•¨ìˆ˜
      const getPriority = (member: Member) => {
        if (member.roles.includes('Worship Team Leader')) return 1
        if (member.roles.includes('Session Leader')) return 2
        if (member.roles.includes('Elder')) return 3
        if (member.roles.includes('Planning Team Leader')) return 4
        return 5 // ë‚˜ë¨¸ì§€
      }

      const priorityA = getPriority(a)
      const priorityB = getPriority(b)

      // ìš°ì„ ìˆœìœ„ê°€ ë‹¤ë¥´ë©´ ìš°ì„ ìˆœìœ„ë¡œ ì •ë ¬
      if (priorityA !== priorityB) {
        return priorityA - priorityB
      }

      // ìš°ì„ ìˆœìœ„ê°€ ê°™ìœ¼ë©´ ì´ë¦„ìˆœ
      return a.name.localeCompare(b.name, 'ko-KR')
    })
  }

  return filtered
})

const handleMainFilter = (value: 'all' | 'leader' | 'worship' | 'step') => {
  filter.value = value
  worshipFilter.value = ''
  stepFilter.value = ''
}
</script>